import{t as e}from"./chunk-VELTKBKT-D4etArbK.js";import{V as t,m as n,p as r}from"./chunk-JIN56HTB-ZHdLGKd3.js";import{A as i,B as a,C as o,E as s,F as c,G as l,K as u,N as d,O as f,R as p,S as m,W as h,a as g,d as _,g as ee,h as v,i as te,j as y,o as b,p as x,r as S,s as C,u as ne,v as w,x as T}from"./chunk-H3VCZNTA-BPKkdVoK.js";import{t as E}from"./chunk-M3I2T2XC-CUWGm2ql.js";function D(e,t,n,r){var i;do i=p(r);while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}e(D,`addDummyNode`);function re(e){var t=new E().setGraph(e.graph());return o(e.nodes(),function(n){t.setNode(n,e.node(n))}),o(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t}e(re,`simplify`);function O(e){var t=new E({multigraph:e.isMultigraph()}).setGraph(e.graph());return o(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),o(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t}e(O,`asNonCompoundGraph`);function k(e,t){var n=e.x,r=e.y,i=t.x-n,a=t.y-r,o=e.width/2,s=e.height/2;if(!i&&!a)throw Error(`Not possible to find intersection inside of the rectangle`);var c,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=s*i/a,l=s):(i<0&&(o=-o),c=o,l=o*a/i),{x:n+c,y:r+l}}e(k,`intersectRect`);function A(e){var t=b(g(j(e)+1),function(){return[]});return o(e.nodes(),function(n){var r=e.node(n),i=r.rank;h(i)||(t[i][r.order]=n)}),t}e(A,`buildLayerMatrix`);function ie(e){var t=u(b(e.nodes(),function(t){return e.node(t).rank}));o(e.nodes(),function(n){var r=e.node(n);i(r,`rank`)&&(r.rank-=t)})}e(ie,`normalizeRanks`);function ae(e){var t=u(b(e.nodes(),function(t){return e.node(t).rank})),n=[];o(e.nodes(),function(r){var i=e.node(r).rank-t;n[i]||(n[i]=[]),n[i].push(r)});var r=0,i=e.graph().nodeRankFactor;o(n,function(t,n){h(t)&&n%i!==0?--r:r&&o(t,function(t){e.node(t).rank+=r})})}e(ae,`removeEmptyRanks`);function oe(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),D(e,`border`,i,t)}e(oe,`addBorderNode`);function j(e){return s(b(e.nodes(),function(t){var n=e.node(t).rank;if(!h(n))return n}))}e(j,`maxRank`);function se(e,t){var n={lhs:[],rhs:[]};return o(e,function(e){t(e)?n.lhs.push(e):n.rhs.push(e)}),n}e(se,`partition`);function ce(e,t){var n=ee();try{return t()}finally{console.log(e+` time: `+(ee()-n)+`ms`)}}e(ce,`time`);function le(e,t){return t()}e(le,`notime`);function ue(t){function n(e){var r=t.children(e),i=t.node(e);if(r.length&&o(r,n),Object.prototype.hasOwnProperty.call(i,`minRank`)){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,s=i.maxRank+1;a<s;++a)M(t,`borderLeft`,`_bl`,e,i,a),M(t,`borderRight`,`_br`,e,i,a)}}e(n,`dfs`),o(t.children(),n)}e(ue,`addBorderSegments`);function M(e,t,n,r,i,a){var o={width:0,height:0,rank:a,borderType:t},s=i[t][a-1],c=D(e,`border`,o,n);i[t][a]=c,e.setParent(c,r),s&&e.setEdge(s,c,{weight:1})}e(M,`addBorderNode`);function de(e){var t=e.graph().rankdir.toLowerCase();(t===`lr`||t===`rl`)&&N(e)}e(de,`adjust`);function fe(e){var t=e.graph().rankdir.toLowerCase();(t===`bt`||t===`rl`)&&pe(e),(t===`lr`||t===`rl`)&&(me(e),N(e))}e(fe,`undo`);function N(e){o(e.nodes(),function(t){P(e.node(t))}),o(e.edges(),function(t){P(e.edge(t))})}e(N,`swapWidthHeight`);function P(e){var t=e.width;e.width=e.height,e.height=t}e(P,`swapWidthHeightOne`);function pe(e){o(e.nodes(),function(t){F(e.node(t))}),o(e.edges(),function(t){var n=e.edge(t);o(n.points,F),Object.prototype.hasOwnProperty.call(n,`y`)&&F(n)})}e(pe,`reverseY`);function F(e){e.y=-e.y}e(F,`reverseYOne`);function me(e){o(e.nodes(),function(t){I(e.node(t))}),o(e.edges(),function(t){var n=e.edge(t);o(n.points,I),Object.prototype.hasOwnProperty.call(n,`x`)&&I(n)})}e(me,`swapXY`);function I(e){var t=e.x;e.x=e.y,e.y=t}e(I,`swapXYOne`);var he=class{static{e(this,`List`)}constructor(){var e={};e._next=e._prev=e,this._sentinel=e}dequeue(){var e=this._sentinel,t=e._prev;if(t!==e)return L(t),t}enqueue(e){var t=this._sentinel;e._prev&&e._next&&L(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t}toString(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,ge)),n=n._prev;return`[`+e.join(`, `)+`]`}};function L(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}e(L,`unlink`);function ge(e,t){if(e!==`_next`&&e!==`_prev`)return t}e(ge,`filterOutLinks`);var _e=r(1);function ve(e,t){if(e.nodeCount()<=1)return[];var n=be(e,t||_e);return x(b(ye(n.graph,n.buckets,n.zeroIdx),function(t){return e.outEdges(t.v,t.w)}))}e(ve,`greedyFAS`);function ye(e,t,n){for(var r=[],i=t[t.length-1],a=t[0],o;e.nodeCount();){for(;o=a.dequeue();)R(e,t,n,o);for(;o=i.dequeue();)R(e,t,n,o);if(e.nodeCount()){for(var s=t.length-2;s>0;--s)if(o=t[s].dequeue(),o){r=r.concat(R(e,t,n,o,!0));break}}}return r}e(ye,`doGreedyFAS`);function R(e,t,n,r,i){var a=i?[]:void 0;return o(e.inEdges(r.v),function(r){var o=e.edge(r),s=e.node(r.v);i&&a.push({v:r.v,w:r.w}),s.out-=o,z(t,n,s)}),o(e.outEdges(r.v),function(r){var i=e.edge(r),a=r.w,o=e.node(a);o.in-=i,z(t,n,o)}),e.removeNode(r.v),a}e(R,`removeNode`);function be(e,t){var n=new E,r=0,i=0;o(e.nodes(),function(e){n.setNode(e,{v:e,in:0,out:0})}),o(e.edges(),function(e){var a=n.edge(e.v,e.w)||0,o=t(e),s=a+o;n.setEdge(e.v,e.w,s),i=Math.max(i,n.node(e.v).out+=o),r=Math.max(r,n.node(e.w).in+=o)});var a=g(i+r+3).map(function(){return new he}),s=r+1;return o(n.nodes(),function(e){z(a,s,n.node(e))}),{graph:n,buckets:a,zeroIdx:s}}e(be,`buildState`);function z(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}e(z,`assignBucket`);function xe(t){o(t.graph().acyclicer===`greedy`?ve(t,n(t)):Se(t),function(e){var n=t.edge(e);t.removeEdge(e),n.forwardName=e.name,n.reversed=!0,t.setEdge(e.w,e.v,n,p(`rev`))});function n(e){return function(t){return e.edge(t).weight}}e(n,`weightFn`)}e(xe,`run`);function Se(t){var n=[],r={},i={};function a(e){Object.prototype.hasOwnProperty.call(i,e)||(i[e]=!0,r[e]=!0,o(t.outEdges(e),function(e){Object.prototype.hasOwnProperty.call(r,e.w)?n.push(e):a(e.w)}),delete r[e])}return e(a,`dfs`),o(t.nodes(),a),n}e(Se,`dfsFAS`);function Ce(e){o(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}e(Ce,`undo`);function we(e){e.graph().dummyChains=[],o(e.edges(),function(t){Te(e,t)})}e(we,`run`);function Te(e,t){var n=t.v,r=e.node(n).rank,i=t.w,a=e.node(i).rank,o=t.name,s=e.edge(t),c=s.labelRank;if(a!==r+1){e.removeEdge(t);var l=void 0,u,d;for(d=0,++r;r<a;++d,++r)s.points=[],l={width:0,height:0,edgeLabel:s,edgeObj:t,rank:r},u=D(e,`edge`,l,`_d`),r===c&&(l.width=s.width,l.height=s.height,l.dummy=`edge-label`,l.labelpos=s.labelpos),e.setEdge(n,u,{weight:s.weight},o),d===0&&e.graph().dummyChains.push(u),n=u;e.setEdge(n,i,{weight:s.weight},o)}}e(Te,`normalizeEdge`);function Ee(e){o(e.graph().dummyChains,function(t){var n=e.node(t),r=n.edgeLabel,i;for(e.setEdge(n.edgeObj,r);n.dummy;)i=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy===`edge-label`&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=i,n=e.node(t)})}e(Ee,`undo`);function B(t){var n={};function r(e){var i=t.node(e);if(Object.prototype.hasOwnProperty.call(n,e))return i.rank;n[e]=!0;var a=u(b(t.outEdges(e),function(e){return r(e.w)-t.edge(e).minlen}));return(a===1/0||a==null)&&(a=0),i.rank=a}e(r,`dfs`),o(t.sources(),r)}e(B,`longestPath`);function V(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}e(V,`slack`);function H(e){var t=new E({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var i,a;De(t,e)<r;)i=Oe(t,e),a=t.hasNode(i.v)?V(e,i):-V(e,i),ke(t,e,a);return t}e(H,`feasibleTree`);function De(t,n){function r(e){o(n.nodeEdges(e),function(i){var a=i.v,o=e===a?i.w:a;!t.hasNode(o)&&!V(n,i)&&(t.setNode(o,{}),t.setEdge(e,o,{}),r(o))})}return e(r,`dfs`),o(t.nodes(),r),t.nodeCount()}e(De,`tightTree`);function Oe(e,t){return _(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return V(t,n)})}e(Oe,`findMinSlackEdge`);function ke(e,t,n){o(e.nodes(),function(e){t.node(e).rank+=n})}e(ke,`shiftRanks`),r(1),r(1),Ae.CycleException=U;function Ae(t){var n={},r={},i=[];function a(e){if(Object.prototype.hasOwnProperty.call(r,e))throw new U;Object.prototype.hasOwnProperty.call(n,e)||(r[e]=!0,n[e]=!0,o(t.predecessors(e),a),delete r[e],i.push(e))}if(e(a,`visit`),o(t.sinks(),a),l(n)!==t.nodeCount())throw new U;return i}e(Ae,`topsort`);function U(){}e(U,`CycleException`),U.prototype=Error();function W(e,t,r){n(t)||(t=[t]);var i=(e.isDirected()?e.successors:e.neighbors).bind(e),a=[],s={};return o(t,function(t){if(!e.hasNode(t))throw Error(`Graph does not have node: `+t);G(e,t,r===`post`,s,i,a)}),a}e(W,`dfs`);function G(e,t,n,r,i,a){Object.prototype.hasOwnProperty.call(r,t)||(r[t]=!0,n||a.push(t),o(i(t),function(t){G(e,t,n,r,i,a)}),n&&a.push(t))}e(G,`doDfs`);function je(e,t){return W(e,t,`post`)}e(je,`postorder`);function Me(e,t){return W(e,t,`pre`)}e(Me,`preorder`),K.initLowLimValues=Y,K.initCutValues=q,K.calcCutValue=J,K.leaveEdge=Pe,K.enterEdge=Fe,K.exchangeEdges=Ie;function K(e){e=re(e),B(e);var t=H(e);Y(t),q(t,e);for(var n,r;n=Pe(t);)r=Fe(t,e,n),Ie(t,e,n,r)}e(K,`networkSimplex`);function q(e,t){var n=je(e,e.nodes());n=n.slice(0,n.length-1),o(n,function(n){Ne(e,t,n)})}e(q,`initCutValues`);function Ne(e,t,n){var r=e.node(n).parent;e.edge(n,r).cutvalue=J(e,t,n)}e(Ne,`assignCutValue`);function J(e,t,n){var r=e.node(n).parent,i=!0,a=t.edge(n,r),s=0;return a||=(i=!1,t.edge(r,n)),s=a.weight,o(t.nodeEdges(n),function(a){var o=a.v===n,c=o?a.w:a.v;if(c!==r){var l=o===i,u=t.edge(a).weight;if(s+=l?u:-u,Re(e,n,c)){var d=e.edge(n,c).cutvalue;s+=l?-d:d}}}),s}e(J,`calcCutValue`);function Y(e,t){arguments.length<2&&(t=e.nodes()[0]),X(e,{},1,t)}e(Y,`initLowLimValues`);function X(e,t,n,r,i){var a=n,s=e.node(r);return t[r]=!0,o(e.neighbors(r),function(i){Object.prototype.hasOwnProperty.call(t,i)||(n=X(e,t,n,i,r))}),s.low=a,s.lim=n++,i?s.parent=i:delete s.parent,n}e(X,`dfsAssignLowLim`);function Pe(e){return C(e.edges(),function(t){return e.edge(t).cutvalue<0})}e(Pe,`leaveEdge`);function Fe(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var a=e.node(r),o=e.node(i),s=a,c=!1;return a.lim>o.lim&&(s=o,c=!0),_(y(t.edges(),function(t){return c===ze(e,e.node(t.v),s)&&c!==ze(e,e.node(t.w),s)}),function(e){return V(t,e)})}e(Fe,`enterEdge`);function Ie(e,t,n,r){var i=n.v,a=n.w;e.removeEdge(i,a),e.setEdge(r.v,r.w,{}),Y(e),q(e,t),Le(e,t)}e(Ie,`exchangeEdges`);function Le(e,t){var n=Me(e,C(e.nodes(),function(e){return!t.node(e).parent}));n=n.slice(1),o(n,function(n){var r=e.node(n).parent,i=t.edge(n,r),a=!1;i||(i=t.edge(r,n),a=!0),t.node(n).rank=t.node(r).rank+(a?i.minlen:-i.minlen)})}e(Le,`updateRanks`);function Re(e,t,n){return e.hasEdge(t,n)}e(Re,`isTreeEdge`);function ze(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}e(ze,`isDescendant`);function Be(e){switch(e.graph().ranker){case`network-simplex`:Z(e);break;case`tight-tree`:He(e);break;case`longest-path`:Ve(e);break;default:Z(e)}}e(Be,`rank`);var Ve=B;function He(e){B(e),H(e)}e(He,`tightTreeRanker`);function Z(e){K(e)}e(Z,`networkSimplexRanker`);function Ue(e){var t=D(e,`root`,{},`_root`),n=Ge(e),r=s(T(n))-1,i=2*r+1;e.graph().nestingRoot=t,o(e.edges(),function(t){e.edge(t).minlen*=i});var a=Ke(e)+1;o(e.children(),function(o){We(e,t,i,a,r,n,o)}),e.graph().nodeRankFactor=i}e(Ue,`run`);function We(e,t,n,r,i,a,s){var c=e.children(s);if(!c.length){s!==t&&e.setEdge(t,s,{weight:0,minlen:n});return}var l=oe(e,`_bt`),u=oe(e,`_bb`),d=e.node(s);e.setParent(l,s),d.borderTop=l,e.setParent(u,s),d.borderBottom=u,o(c,function(o){We(e,t,n,r,i,a,o);var c=e.node(o),d=c.borderTop?c.borderTop:o,f=c.borderBottom?c.borderBottom:o,p=c.borderTop?r:2*r,m=d===f?i-a[s]+1:1;e.setEdge(l,d,{weight:p,minlen:m,nestingEdge:!0}),e.setEdge(f,u,{weight:p,minlen:m,nestingEdge:!0})}),e.parent(s)||e.setEdge(t,l,{weight:0,minlen:i+a[s]})}e(We,`dfs`);function Ge(t){var n={};function r(e,i){var a=t.children(e);a&&a.length&&o(a,function(e){r(e,i+1)}),n[e]=i}return e(r,`dfs`),o(t.children(),function(e){r(e,1)}),n}e(Ge,`treeDepths`);function Ke(e){return v(e.edges(),function(t,n){return t+e.edge(n).weight},0)}e(Ke,`sumWeights`);function qe(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,o(e.edges(),function(t){e.edge(t).nestingEdge&&e.removeEdge(t)})}e(qe,`cleanup`);function Je(e,t,n){var r={},i;o(n,function(n){for(var a=e.parent(n),o,s;a;){if(o=e.parent(a),o?(s=r[o],r[o]=a):(s=i,i=a),s&&s!==a){t.setEdge(s,a);return}a=o}})}e(Je,`addSubgraphConstraints`);function Ye(e,t,n){var r=Xe(e),i=new E({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(t){return e.node(t)});return o(e.nodes(),function(a){var s=e.node(a),c=e.parent(a);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(i.setNode(a),i.setParent(a,c||r),o(e[n](a),function(t){var n=t.v===a?t.w:t.v,r=i.edge(n,a),o=h(r)?0:r.weight;i.setEdge(n,a,{weight:e.edge(t).weight+o})}),Object.prototype.hasOwnProperty.call(s,`minRank`)&&i.setNode(a,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),i}e(Ye,`buildLayerGraph`);function Xe(e){for(var t;e.hasNode(t=p(`_root`)););return t}e(Xe,`createRootNode`);function Ze(e,t){for(var n=0,r=1;r<t.length;++r)n+=Qe(e,t[r-1],t[r]);return n}e(Ze,`crossCount`);function Qe(e,t,n){for(var r=d(n,b(n,function(e,t){return t})),i=x(b(t,function(t){return a(b(e.outEdges(t),function(t){return{pos:r[t.w],weight:e.edge(t).weight}}),`pos`)})),s=1;s<n.length;)s<<=1;var c=2*s-1;--s;var l=b(Array(c),function(){return 0}),u=0;return o(i.forEach(function(e){var t=e.pos+s;l[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=l[t+1]),t=t-1>>1,l[t]+=e.weight;u+=e.weight*n})),u}e(Qe,`twoLayerCrossCount`);function $e(t){var n={},r=y(t.nodes(),function(e){return!t.children(e).length}),c=b(g(s(b(r,function(e){return t.node(e).rank}))+1),function(){return[]});function l(e){i(n,e)||(n[e]=!0,c[t.node(e).rank].push(e),o(t.successors(e),l))}return e(l,`dfs`),o(a(r,function(e){return t.node(e).rank}),l),c}e($e,`initOrder`);function et(e,t){return b(t,function(t){var n=e.inEdges(t);if(n.length){var r=v(n,function(t,n){var r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight}},{sum:0,weight:0});return{v:t,barycenter:r.sum/r.weight,weight:r.weight}}else return{v:t}})}e(et,`barycenter`);function tt(e,t){var n={};return o(e,function(e,t){var r=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};h(e.barycenter)||(r.barycenter=e.barycenter,r.weight=e.weight)}),o(t.edges(),function(e){var t=n[e.v],r=n[e.w];!h(t)&&!h(r)&&(r.indegree++,t.out.push(n[e.w]))}),nt(y(n,function(e){return!e.indegree}))}e(tt,`resolveConflicts`);function nt(t){var n=[];function r(e){return function(t){t.merged||(h(t.barycenter)||h(e.barycenter)||t.barycenter>=e.barycenter)&&rt(e,t)}}e(r,`handleIn`);function i(e){return function(n){n.in.push(e),--n.indegree===0&&t.push(n)}}for(e(i,`handleOut`);t.length;){var a=t.pop();n.push(a),o(a.in.reverse(),r(a)),o(a.out,i(a))}return b(y(n,function(e){return!e.merged}),function(e){return w(e,[`vs`,`i`,`barycenter`,`weight`])})}e(nt,`doResolveConflicts`);function rt(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}e(rt,`mergeEntries`);function it(e,t){var n=se(e,function(e){return Object.prototype.hasOwnProperty.call(e,`barycenter`)}),r=n.lhs,i=a(n.rhs,function(e){return-e.i}),s=[],c=0,l=0,u=0;r.sort(ot(!!t)),u=at(s,i,u),o(r,function(e){u+=e.vs.length,s.push(e.vs),c+=e.barycenter*e.weight,l+=e.weight,u=at(s,i,u)});var d={vs:x(s)};return l&&(d.barycenter=c/l,d.weight=l),d}e(it,`sort`);function at(e,t,n){for(var r;t.length&&(r=S(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}e(at,`consumeUnsortable`);function ot(e){return function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}}e(ot,`compareWithBias`);function st(e,t,n,r){var i=e.children(t),a=e.node(t),s=a?a.borderLeft:void 0,c=a?a.borderRight:void 0,l={};s&&(i=y(i,function(e){return e!==s&&e!==c}));var u=et(e,i);o(u,function(t){if(e.children(t.v).length){var i=st(e,t.v,n,r);l[t.v]=i,Object.prototype.hasOwnProperty.call(i,`barycenter`)&&lt(t,i)}});var d=tt(u,n);ct(d,l);var f=it(d,r);if(s&&(f.vs=x([s,f.vs,c]),e.predecessors(s).length)){var p=e.node(e.predecessors(s)[0]),m=e.node(e.predecessors(c)[0]);Object.prototype.hasOwnProperty.call(f,`barycenter`)||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+m.order)/(f.weight+2),f.weight+=2}return f}e(st,`sortSubgraph`);function ct(e,t){o(e,function(e){e.vs=x(e.vs.map(function(e){return t[e]?t[e].vs:e}))})}e(ct,`expandSubgraphs`);function lt(e,t){h(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}e(lt,`mergeBarycenters`);function ut(e){var t=j(e),n=dt(e,g(1,t+1),`inEdges`),r=dt(e,g(t-1,-1,-1),`outEdges`),i=$e(e);pt(e,i);for(var a=1/0,o,s=0,l=0;l<4;++s,++l){ft(s%2?n:r,s%4>=2),i=A(e);var u=Ze(e,i);u<a&&(l=0,o=c(i),a=u)}pt(e,o)}e(ut,`order`);function dt(e,t,n){return b(t,function(t){return Ye(e,t,n)})}e(dt,`buildLayerGraphs`);function ft(e,t){var n=new E;o(e,function(e){var r=e.graph().root,i=st(e,r,n,t);o(i.vs,function(t,n){e.node(t).order=n}),Je(e,n,i.vs)})}e(ft,`sweepLayerGraphs`);function pt(e,t){o(t,function(t){o(t,function(t,n){e.node(t).order=n})})}e(pt,`assignOrder`);function mt(e){var t=gt(e);o(e.graph().dummyChains,function(n){for(var r=e.node(n),i=r.edgeObj,a=ht(e,t,i.v,i.w),o=a.path,s=a.lca,c=0,l=o[c],u=!0;n!==i.w;){if(r=e.node(n),u){for(;(l=o[c])!==s&&e.node(l).maxRank<r.rank;)c++;l===s&&(u=!1)}if(!u){for(;c<o.length-1&&e.node(l=o[c+1]).minRank<=r.rank;)c++;l=o[c]}e.setParent(n,l),n=e.successors(n)[0]}})}e(mt,`parentDummyChains`);function ht(e,t,n,r){var i=[],a=[],o=Math.min(t[n].low,t[r].low),s=Math.max(t[n].lim,t[r].lim),c=n,l;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||s>t[c].lim));for(l=c,c=r;(c=e.parent(c))!==l;)a.push(c);return{path:i.concat(a.reverse()),lca:l}}e(ht,`findPath`);function gt(t){var n={},r=0;function i(e){var a=r;o(t.children(e),i),n[e]={low:a,lim:r++}}return e(i,`dfs`),o(t.children(),i),n}e(gt,`postorder`);function _t(t,n){var r={};function i(e,n){var i=0,a=0,s=e.length,c=S(n);return o(n,function(e,l){var u=yt(t,e),d=u?t.node(u).order:s;(u||e===c)&&(o(n.slice(a,l+1),function(e){o(t.predecessors(e),function(n){var a=t.node(n),o=a.order;(o<i||d<o)&&!(a.dummy&&t.node(e).dummy)&&bt(r,n,e)})}),a=l+1,i=d)}),n}return e(i,`visitLayer`),v(n,i),r}e(_t,`findType1Conflicts`);function vt(t,n){var r={};function i(e,n,i,a,s){var c;o(g(n,i),function(n){c=e[n],t.node(c).dummy&&o(t.predecessors(c),function(e){var n=t.node(e);n.dummy&&(n.order<a||n.order>s)&&bt(r,e,c)})})}e(i,`scan`);function a(e,n){var r=-1,a,s=0;return o(n,function(o,c){if(t.node(o).dummy===`border`){var l=t.predecessors(o);l.length&&(a=t.node(l[0]).order,i(n,s,c,r,a),s=c,r=a)}i(n,s,n.length,a,e.length)}),n}return e(a,`visitLayer`),v(n,a),r}e(vt,`findType2Conflicts`);function yt(e,t){if(e.node(t).dummy)return C(e.predecessors(t),function(t){return e.node(t).dummy})}e(yt,`findOtherInnerSegmentNode`);function bt(e,t,n){if(t>n){var r=t;t=n,n=r}Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(e,t,{enumerable:!0,configurable:!0,value:{},writable:!0});var i=e[t];Object.defineProperty(i,n,{enumerable:!0,configurable:!0,value:!0,writable:!0})}e(bt,`addConflict`);function xt(e,t,n){if(t>n){var r=t;t=n,n=r}return!!e[t]&&Object.prototype.hasOwnProperty.call(e[t],n)}e(xt,`hasConflict`);function St(e,t,n,r){var i={},s={},c={};return o(t,function(e){o(e,function(e,t){i[e]=e,s[e]=e,c[e]=t})}),o(t,function(e){var t=-1;o(e,function(e){var o=r(e);if(o.length){o=a(o,function(e){return c[e]});for(var l=(o.length-1)/2,u=Math.floor(l),d=Math.ceil(l);u<=d;++u){var f=o[u];s[e]===e&&t<c[f]&&!xt(n,e,f)&&(s[f]=e,s[e]=i[e]=i[f],t=c[f])}}})}),{root:i,align:s}}e(St,`verticalAlignment`);function Ct(t,n,r,i,a){var s={},c=wt(t,n,r,a),l=a?`borderLeft`:`borderRight`;function u(e,t){for(var n=c.nodes(),r=n.pop(),i={};r;)i[r]?e(r):(i[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}e(u,`iterate`);function d(e){s[e]=c.inEdges(e).reduce(function(e,t){return Math.max(e,s[t.v]+c.edge(t))},0)}e(d,`pass1`);function f(e){var n=c.outEdges(e).reduce(function(e,t){return Math.min(e,s[t.w]-c.edge(t))},1/0),r=t.node(e);n!==1/0&&r.borderType!==l&&(s[e]=Math.max(s[e],n))}return e(f,`pass2`),u(d,c.predecessors.bind(c)),u(f,c.successors.bind(c)),o(i,function(e){s[e]=s[r[e]]}),s}e(Ct,`horizontalCompaction`);function wt(e,t,n,r){var i=new E,a=e.graph(),s=kt(a.nodesep,a.edgesep,r);return o(t,function(t){var r;o(t,function(t){var a=n[t];if(i.setNode(a),r){var o=n[r],c=i.edge(o,a);i.setEdge(o,a,Math.max(s(e,t,r),c||0))}r=t})}),i}e(wt,`buildBlockGraph`);function Tt(e,t){return _(T(t),function(t){var n=-1/0,r=1/0;return m(t,function(t,i){var a=At(e,i)/2;n=Math.max(t+a,n),r=Math.min(t-a,r)}),n-r})}e(Tt,`findSmallestWidthAlignment`);function Et(e,t){var n=T(t),r=u(n),i=s(n);o([`u`,`d`],function(n){o([`l`,`r`],function(a){var o=n+a,c=e[o],l;if(c!==t){var d=T(c);l=a===`l`?r-u(d):i-s(d),l&&(e[o]=f(c,function(e){return e+l}))}})})}e(Et,`alignCoordinates`);function Dt(e,t){return f(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var i=a(b(e,r));return(i[1]+i[2])/2})}e(Dt,`balance`);function Ot(e){var n=A(e),r=t(_t(e,n),vt(e,n)),i={},a;return o([`u`,`d`],function(t){a=t===`u`?n:T(n).reverse(),o([`l`,`r`],function(n){n===`r`&&(a=b(a,function(e){return T(e).reverse()}));var o=(t===`u`?e.predecessors:e.successors).bind(e),s=St(e,a,r,o),c=Ct(e,a,s.root,s.align,n===`r`);n===`r`&&(c=f(c,function(e){return-e})),i[t+n]=c})}),Et(i,Tt(e,i)),Dt(i,e.graph().align)}e(Ot,`positionX`);function kt(e,t,n){return function(r,i,a){var o=r.node(i),s=r.node(a),c=0,l;if(c+=o.width/2,Object.prototype.hasOwnProperty.call(o,`labelpos`))switch(o.labelpos.toLowerCase()){case`l`:l=-o.width/2;break;case`r`:l=o.width/2;break}if(l&&(c+=n?l:-l),l=0,c+=(o.dummy?t:e)/2,c+=(s.dummy?t:e)/2,c+=s.width/2,Object.prototype.hasOwnProperty.call(s,`labelpos`))switch(s.labelpos.toLowerCase()){case`l`:l=s.width/2;break;case`r`:l=-s.width/2;break}return l&&(c+=n?l:-l),l=0,c}}e(kt,`sep`);function At(e,t){return e.node(t).width}e(At,`width`);function jt(e){e=O(e),Mt(e),te(Ot(e),function(t,n){e.node(n).x=t})}e(jt,`position`);function Mt(e){var t=A(e),n=e.graph().ranksep,r=0;o(t,function(t){var i=s(b(t,function(t){return e.node(t).height}));o(t,function(t){e.node(t).y=r+i/2}),r+=i+n})}e(Mt,`positionY`);function Nt(e,t){var n=t&&t.debugTiming?ce:le;n(`layout`,()=>{var t=n(`  buildLayoutGraph`,()=>Wt(e));n(`  runLayout`,()=>Pt(t,n)),n(`  updateInputGraph`,()=>Ft(e,t))})}e(Nt,`layout`);function Pt(e,t){t(`    makeSpaceForEdgeLabels`,()=>Gt(e)),t(`    removeSelfEdges`,()=>en(e)),t(`    acyclic`,()=>xe(e)),t(`    nestingGraph.run`,()=>Ue(e)),t(`    rank`,()=>Be(O(e))),t(`    injectEdgeLabelProxies`,()=>Kt(e)),t(`    removeEmptyRanks`,()=>ae(e)),t(`    nestingGraph.cleanup`,()=>qe(e)),t(`    normalizeRanks`,()=>ie(e)),t(`    assignRankMinMax`,()=>qt(e)),t(`    removeEdgeLabelProxies`,()=>Jt(e)),t(`    normalize.run`,()=>we(e)),t(`    parentDummyChains`,()=>mt(e)),t(`    addBorderSegments`,()=>ue(e)),t(`    order`,()=>ut(e)),t(`    insertSelfEdges`,()=>tn(e)),t(`    adjustCoordinateSystem`,()=>de(e)),t(`    position`,()=>jt(e)),t(`    positionSelfEdges`,()=>nn(e)),t(`    removeBorderNodes`,()=>$t(e)),t(`    normalize.undo`,()=>Ee(e)),t(`    fixupEdgeLabelCoords`,()=>Zt(e)),t(`    undoCoordinateSystem`,()=>fe(e)),t(`    translateGraph`,()=>Yt(e)),t(`    assignNodeIntersects`,()=>Xt(e)),t(`    reversePoints`,()=>Qt(e)),t(`    acyclic.undo`,()=>Ce(e))}e(Pt,`runLayout`);function Ft(e,t){o(e.nodes(),function(n){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height))}),o(e.edges(),function(n){var r=e.edge(n),i=t.edge(n);r.points=i.points,Object.prototype.hasOwnProperty.call(i,`x`)&&(r.x=i.x,r.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}e(Ft,`updateInputGraph`);var It=[`nodesep`,`edgesep`,`ranksep`,`marginx`,`marginy`],Lt={ranksep:50,edgesep:20,nodesep:50,rankdir:`tb`},Rt=[`acyclicer`,`ranker`,`rankdir`,`align`],zt=[`width`,`height`],Bt={width:0,height:0},Vt=[`minlen`,`weight`,`width`,`height`,`labeloffset`],Ht={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:`r`},Ut=[`labelpos`];function Wt(e){var n=new E({multigraph:!0,compound:!0}),r=$(e.graph());return n.setGraph(t({},Lt,Q(r,It),w(r,Rt))),o(e.nodes(),function(t){var r=$(e.node(t));n.setNode(t,ne(Q(r,zt),Bt)),n.setParent(t,e.parent(t))}),o(e.edges(),function(r){var i=$(e.edge(r));n.setEdge(r,t({},Ht,Q(i,Vt),w(i,Ut)))}),n}e(Wt,`buildLayoutGraph`);function Gt(e){var t=e.graph();t.ranksep/=2,o(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!==`c`&&(t.rankdir===`TB`||t.rankdir===`BT`?r.width+=r.labeloffset:r.height+=r.labeloffset)})}e(Gt,`makeSpaceForEdgeLabels`);function Kt(e){o(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v);D(e,`edge-proxy`,{rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t},`_ep`)}})}e(Kt,`injectEdgeLabelProxies`);function qt(e){var t=0;o(e.nodes(),function(n){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=s(t,r.maxRank))}),e.graph().maxRank=t}e(qt,`assignRankMinMax`);function Jt(e){o(e.nodes(),function(t){var n=e.node(t);n.dummy===`edge-proxy`&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}e(Jt,`removeEdgeLabelProxies`);function Yt(t){var n=1/0,r=0,i=1/0,a=0,s=t.graph(),c=s.marginx||0,l=s.marginy||0;function u(e){var t=e.x,o=e.y,s=e.width,c=e.height;n=Math.min(n,t-s/2),r=Math.max(r,t+s/2),i=Math.min(i,o-c/2),a=Math.max(a,o+c/2)}e(u,`getExtremes`),o(t.nodes(),function(e){u(t.node(e))}),o(t.edges(),function(e){var n=t.edge(e);Object.prototype.hasOwnProperty.call(n,`x`)&&u(n)}),n-=c,i-=l,o(t.nodes(),function(e){var r=t.node(e);r.x-=n,r.y-=i}),o(t.edges(),function(e){var r=t.edge(e);o(r.points,function(e){e.x-=n,e.y-=i}),Object.prototype.hasOwnProperty.call(r,`x`)&&(r.x-=n),Object.prototype.hasOwnProperty.call(r,`y`)&&(r.y-=i)}),s.width=r-n+c,s.height=a-i+l}e(Yt,`translateGraph`);function Xt(e){o(e.edges(),function(t){var n=e.edge(t),r=e.node(t.v),i=e.node(t.w),a,o;n.points?(a=n.points[0],o=n.points[n.points.length-1]):(n.points=[],a=i,o=r),n.points.unshift(k(r,a)),n.points.push(k(i,o))})}e(Xt,`assignNodeIntersects`);function Zt(e){o(e.edges(),function(t){var n=e.edge(t);if(Object.prototype.hasOwnProperty.call(n,`x`))switch((n.labelpos===`l`||n.labelpos===`r`)&&(n.width-=n.labeloffset),n.labelpos){case`l`:n.x-=n.width/2+n.labeloffset;break;case`r`:n.x+=n.width/2+n.labeloffset;break}})}e(Zt,`fixupEdgeLabelCoords`);function Qt(e){o(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}e(Qt,`reversePointsForReversedEdges`);function $t(e){o(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),i=e.node(n.borderBottom),a=e.node(S(n.borderLeft)),o=e.node(S(n.borderRight));n.width=Math.abs(o.x-a.x),n.height=Math.abs(i.y-r.y),n.x=a.x+n.width/2,n.y=r.y+n.height/2}}),o(e.nodes(),function(t){e.node(t).dummy===`border`&&e.removeNode(t)})}e($t,`removeBorderNodes`);function en(e){o(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||=[],n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}e(en,`removeSelfEdges`);function tn(e){o(A(e),function(t){var n=0;o(t,function(t,r){var i=e.node(t);i.order=r+n,o(i.selfEdges,function(t){D(e,`selfedge`,{width:t.label.width,height:t.label.height,rank:i.rank,order:r+ ++n,e:t.e,label:t.label},`_se`)}),delete i.selfEdges})})}e(tn,`insertSelfEdges`);function nn(e){o(e.nodes(),function(t){var n=e.node(t);if(n.dummy===`selfedge`){var r=e.node(n.e.v),i=r.x+r.width/2,a=r.y,o=n.x-i,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{x:i+o,y:a},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],n.label.x=n.x,n.label.y=n.y}})}e(nn,`positionSelfEdges`);function Q(e,t){return f(w(e,t),Number)}e(Q,`selectNumberAttrs`);function $(e){var t={};return o(e,function(e,n){t[n.toLowerCase()]=e}),t}e($,`canonicalize`);export{Nt as t};