import{o as e,t}from"./chunk-VELTKBKT-D4etArbK.js";import{F as n,V as r}from"./chunk-JIN56HTB-ZHdLGKd3.js";import{$ as i,D as a,F as o,L as s,O as c,Q as l,S as u,V as ee,Y as d,_ as f,b as te,d as ne,f as p,g as m,h,j as re,o as ie,q as g,r as ae,u as oe,x as se,z as _}from"./chunk-56PIJBDL-D246tURG.js";import{$ as v,K as ce,R as y,S as b,u as x}from"./chunk-SQX4BMY3-n7esmWhz.js";import{t as S}from"./chunk-XBXGYYE5-P_n1WUHA.js";var C=e(S(),1),w={curveBasis:ae,curveBasisClosed:oe,curveBasisOpen:u,curveBumpX:f,curveBumpY:l,curveBundle:p,curveCardinalClosed:d,curveCardinalOpen:re,curveCardinal:ie,curveCatmullRomClosed:o,curveCatmullRomOpen:ne,curveCatmullRom:a,curveLinear:c,curveLinearClosed:i,curveMonotoneX:s,curveMonotoneY:te,curveNatural:_,curveStep:se,curveStepAfter:h,curveStepBefore:m},T=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,E=t(function(e,t){let n=D(e,/(?:init\b)|(?:initialize\b)/),r={};if(Array.isArray(n)){let e=n.map(e=>e.args);x(e),r=v(r,[...e])}else r=n.args;if(!r)return;let i=ce(e,t),a=`config`;return r[a]!==void 0&&(i===`flowchart-v2`&&(i=`flowchart`),r[i]=r[a],delete r[a]),r},`detectInit`),D=t(function(e,t=null){try{let n=RegExp(`[%]{2}(?![{]${T.source})(?=[}][%]{2}).*
`,`ig`);e=e.trim().replace(n,``).replace(/'/gm,`"`),g.debug(`Detecting diagram directive${t===null?``:` type:`+t} based on the text:${e}`);let r,i=[];for(;(r=b.exec(e))!==null;)if(r.index===b.lastIndex&&b.lastIndex++,r&&!t||t&&r[1]?.match(t)||t&&r[2]?.match(t)){let e=r[1]?r[1]:r[2],t=r[3]?r[3].trim():r[4]?JSON.parse(r[4].trim()):null;i.push({type:e,args:t})}return i.length===0?{type:e,args:null}:i.length===1?i[0]:i}catch(n){return g.error(`ERROR: ${n.message} - Unable to parse directive type: '${t}' based on the text: '${e}'`),{type:void 0,args:null}}},`detectDirective`),le=t(function(e){return e.replace(b,``)},`removeDirectives`),ue=t(function(e,t){for(let[n,r]of t.entries())if(r.match(e))return n;return-1},`isSubstringInArray`);function O(e,t){return e?w[`curve${e.charAt(0).toUpperCase()+e.slice(1)}`]??t:t}t(O,`interpolateToCurve`);function k(e,t){let n=e.trim();if(n)return t.securityLevel===`loose`?n:(0,C.sanitizeUrl)(n)}t(k,`formatUrl`);var A=t((e,...t)=>{let n=e.split(`.`),r=n.length-1,i=n[r],a=window;for(let t=0;t<r;t++)if(a=a[n[t]],!a){g.error(`Function name: ${e} not found in window`);return}a[i](...t)},`runFunc`);function j(e,t){return!e||!t?0:Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)}t(j,`distance`);function M(e){let t,n=0;return e.forEach(e=>{n+=j(e,t),t=e}),F(e,n/2)}t(M,`traverseEdge`);function N(e){return e.length===1?e[0]:M(e)}t(N,`calcLabelPosition`);var P=t((e,t=2)=>{let n=10**t;return Math.round(e*n)/n},`roundNumber`),F=t((e,t)=>{let n,r=t;for(let t of e){if(n){let e=j(t,n);if(e===0)return n;if(e<r)r-=e;else{let i=r/e;if(i<=0)return n;if(i>=1)return{x:t.x,y:t.y};if(i>0&&i<1)return{x:P((1-i)*n.x+i*t.x,5),y:P((1-i)*n.y+i*t.y,5)}}}n=t}throw Error(`Could not find a suitable point for the given distance`)},`calculatePoint`),I=t((e,t,n)=>{g.info(`our points ${JSON.stringify(t)}`),t[0]!==n&&(t=t.reverse());let r=F(t,25),i=e?10:5,a=Math.atan2(t[0].y-r.y,t[0].x-r.x),o={x:0,y:0};return o.x=Math.sin(a)*i+(t[0].x+r.x)/2,o.y=-Math.cos(a)*i+(t[0].y+r.y)/2,o},`calcCardinalityPosition`);function L(e,t,n){let r=structuredClone(n);g.info(`our points`,r),t!==`start_left`&&t!==`start_right`&&r.reverse();let i=F(r,25+e),a=10+e*.5,o=Math.atan2(r[0].y-i.y,r[0].x-i.x),s={x:0,y:0};return t===`start_left`?(s.x=Math.sin(o+Math.PI)*a+(r[0].x+i.x)/2,s.y=-Math.cos(o+Math.PI)*a+(r[0].y+i.y)/2):t===`end_right`?(s.x=Math.sin(o-Math.PI)*a+(r[0].x+i.x)/2-5,s.y=-Math.cos(o-Math.PI)*a+(r[0].y+i.y)/2-5):t===`end_left`?(s.x=Math.sin(o)*a+(r[0].x+i.x)/2-5,s.y=-Math.cos(o)*a+(r[0].y+i.y)/2-5):(s.x=Math.sin(o)*a+(r[0].x+i.x)/2,s.y=-Math.cos(o)*a+(r[0].y+i.y)/2),s}t(L,`calcTerminalLabelPosition`);function R(e){let t=``,n=``;for(let r of e)r!==void 0&&(r.startsWith(`color:`)||r.startsWith(`text-align:`)?n=n+r+`;`:t=t+r+`;`);return{style:t,labelStyle:n}}t(R,`getStylesFromArray`);var z=0,B=t(()=>(z++,`id-`+Math.random().toString(36).substr(2,12)+`-`+z),`generateId`);function V(e){let t=``;for(let n=0;n<e;n++)t+=`0123456789abcdef`.charAt(Math.floor(Math.random()*16));return t}t(V,`makeRandomHex`);var H=t(e=>V(e.length),`random`),U=t(function(){return{x:0,y:0,fill:void 0,anchor:`start`,style:`#666`,width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0,text:``}},`getTextObj`),de=t(function(e,t){let n=t.text.replace(y.lineBreakRegex,` `),[,r]=X(t.fontSize),i=e.append(`text`);i.attr(`x`,t.x),i.attr(`y`,t.y),i.style(`text-anchor`,t.anchor),i.style(`font-family`,t.fontFamily),i.style(`font-size`,r),i.style(`font-weight`,t.fontWeight),i.attr(`fill`,t.fill),t.class!==void 0&&i.attr(`class`,t.class);let a=i.append(`tspan`);return a.attr(`x`,t.x+t.textMargin*2),a.attr(`fill`,t.fill),a.text(n),i},`drawSimpleText`),W=n((e,t,n)=>{if(!e||(n=Object.assign({fontSize:12,fontWeight:400,fontFamily:`Arial`,joinWith:`<br/>`},n),y.lineBreakRegex.test(e)))return e;let r=e.split(` `).filter(Boolean),i=[],a=``;return r.forEach((e,o)=>{let s=K(`${e} `,n),c=K(a,n);if(s>t){let{hyphenatedStrings:r,remainingWord:o}=fe(e,t,`-`,n);i.push(a,...r),a=o}else c+s>=t?(i.push(a),a=e):a=[a,e].filter(Boolean).join(` `);o+1===r.length&&i.push(a)}),i.filter(e=>e!==``).join(n.joinWith)},(e,t,n)=>`${e}${t}${n.fontSize}${n.fontWeight}${n.fontFamily}${n.joinWith}`),fe=n((e,t,n=`-`,r)=>{r=Object.assign({fontSize:12,fontWeight:400,fontFamily:`Arial`,margin:0},r);let i=[...e],a=[],o=``;return i.forEach((e,s)=>{let c=`${o}${e}`;if(K(c,r)>=t){let e=s+1,t=i.length===e,r=`${c}${n}`;a.push(t?c:r),o=``}else o=c}),{hyphenatedStrings:a,remainingWord:o}},(e,t,n=`-`,r)=>`${e}${t}${n}${r.fontSize}${r.fontWeight}${r.fontFamily}`);function G(e,t){return q(e,t).height}t(G,`calculateTextHeight`);function K(e,t){return q(e,t).width}t(K,`calculateTextWidth`);var q=n((e,t)=>{let{fontSize:n=12,fontFamily:r=`Arial`,fontWeight:i=400}=t;if(!e)return{width:0,height:0};let[,a]=X(n),o=[`sans-serif`,r],s=e.split(y.lineBreakRegex),c=[],l=ee(`body`);if(!l.remove)return{width:0,height:0,lineHeight:0};let u=l.append(`svg`);for(let e of o){let t=0,n={width:0,height:0,lineHeight:0};for(let r of s){let o=U();o.text=r||`​`;let s=de(u,o).style(`font-size`,a).style(`font-weight`,i).style(`font-family`,e),c=(s._groups||s)[0][0].getBBox();if(c.width===0&&c.height===0)throw Error(`svg element not in render tree`);n.width=Math.round(Math.max(n.width,c.width)),t=Math.round(c.height),n.height+=t,n.lineHeight=Math.round(Math.max(n.lineHeight,t))}c.push(n)}return u.remove(),c[isNaN(c[1].height)||isNaN(c[1].width)||isNaN(c[1].lineHeight)||c[0].height>c[1].height&&c[0].width>c[1].width&&c[0].lineHeight>c[1].lineHeight?0:1]},(e,t)=>`${e}${t.fontSize}${t.fontWeight}${t.fontFamily}`),pe=class{constructor(e=!1,t){this.count=0,this.count=t?t.length:0,this.next=e?()=>this.count++:()=>Date.now()}static{t(this,`InitIDGenerator`)}},J,me=t(function(e){return J||=document.createElement(`div`),e=escape(e).replace(/%26/g,`&`).replace(/%23/g,`#`).replace(/%3B/g,`;`),J.innerHTML=e,unescape(J.textContent)},`entityDecode`);function Y(e){return`str`in e}t(Y,`isDetailedError`);var he=t((e,t,n,r)=>{if(!r)return;let i=e.node()?.getBBox();i&&e.append(`text`).text(r).attr(`text-anchor`,`middle`).attr(`x`,i.x+i.width/2).attr(`y`,-n).attr(`class`,t)},`insertTitle`),X=t(e=>{if(typeof e==`number`)return[e,e+`px`];let t=parseInt(e??``,10);return Number.isNaN(t)?[void 0,void 0]:e===String(t)?[t,e+`px`]:[t,e]},`parseFontSize`);function Z(e,t){return r({},e,t)}t(Z,`cleanAndMerge`);var ge={assignWithDepth:v,wrapLabel:W,calculateTextHeight:G,calculateTextWidth:K,calculateTextDimensions:q,cleanAndMerge:Z,detectInit:E,detectDirective:D,isSubstringInArray:ue,interpolateToCurve:O,calcLabelPosition:N,calcCardinalityPosition:I,calcTerminalLabelPosition:L,formatUrl:k,getStylesFromArray:R,generateId:B,random:H,runFunc:A,entityDecode:me,insertTitle:he,isLabelCoordinateInPath:$,parseFontSize:X,InitIDGenerator:pe},_e=t(function(e){let t=e;return t=t.replace(/style.*:\S*#.*;/g,function(e){return e.substring(0,e.length-1)}),t=t.replace(/classDef.*:\S*#.*;/g,function(e){return e.substring(0,e.length-1)}),t=t.replace(/#\w+;/g,function(e){let t=e.substring(1,e.length-1);return/^\+?\d+$/.test(t)?`ﬂ°°`+t+`¶ß`:`ﬂ°`+t+`¶ß`}),t},`encodeEntities`),ve=t(function(e){return e.replace(/ﬂ°°/g,`&#`).replace(/ﬂ°/g,`&`).replace(/¶ß/g,`;`)},`decodeEntities`),ye=t((e,t,{counter:n=0,prefix:r,suffix:i},a)=>a||`${r?`${r}_`:``}${e}_${t}_${n}${i?`_${i}`:``}`,`getEdgeId`);function Q(e){return e??null}t(Q,`handleUndefinedAttr`);function $(e,t){let n=Math.round(e.x),r=Math.round(e.y),i=t.replace(/(\d+\.\d+)/g,e=>Math.round(parseFloat(e)).toString());return i.includes(n.toString())||i.includes(r.toString())}t($,`isLabelCoordinateInPath`);export{Z as a,ge as c,_e as d,ve as f,le as g,H as h,ye as i,Q as l,O as m,B as n,K as o,R as p,Y as r,W as s,X as t,G as u};