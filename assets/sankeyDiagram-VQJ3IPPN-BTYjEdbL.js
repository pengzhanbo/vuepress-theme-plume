import{t as e}from"./chunk-VELTKBKT-D4etArbK.js";import{V as t,p as n,t as r}from"./chunk-56PIJBDL-D246tURG.js";import{B as i,E as a,I as o,R as s,T as c,U as l,_ as u,o as d,r as f,s as p,t as m}from"./chunk-SQX4BMY3-n7esmWhz.js";var h=(function(){var t=e(function(e,t,n,r){for(n||={},r=e.length;r--;n[e[r]]=t);return n},`o`),n=[1,9],r=[1,10],i=[1,5,10,12],a={trace:e(function(){},`trace`),yy:{},symbols_:{error:2,start:3,SANKEY:4,NEWLINE:5,csv:6,opt_eof:7,record:8,csv_tail:9,EOF:10,"field[source]":11,COMMA:12,"field[target]":13,"field[value]":14,field:15,escaped:16,non_escaped:17,DQUOTE:18,ESCAPED_TEXT:19,NON_ESCAPED_TEXT:20,$accept:0,$end:1},terminals_:{2:`error`,4:`SANKEY`,5:`NEWLINE`,10:`EOF`,11:`field[source]`,12:`COMMA`,13:`field[target]`,14:`field[value]`,18:`DQUOTE`,19:`ESCAPED_TEXT`,20:`NON_ESCAPED_TEXT`},productions_:[0,[3,4],[6,2],[9,2],[9,0],[7,1],[7,0],[8,5],[15,1],[15,1],[16,3],[17,1]],performAction:e(function(e,t,n,r,i,a,o){var s=a.length-1;switch(i){case 7:let e=r.findOrCreateNode(a[s-4].trim().replaceAll(`""`,`"`)),t=r.findOrCreateNode(a[s-2].trim().replaceAll(`""`,`"`)),n=parseFloat(a[s].trim());r.addLink(e,t,n);break;case 8:case 9:case 11:this.$=a[s];break;case 10:this.$=a[s-1];break}},`anonymous`),table:[{3:1,4:[1,2]},{1:[3]},{5:[1,3]},{6:4,8:5,15:6,16:7,17:8,18:n,20:r},{1:[2,6],7:11,10:[1,12]},t(r,[2,4],{9:13,5:[1,14]}),{12:[1,15]},t(i,[2,8]),t(i,[2,9]),{19:[1,16]},t(i,[2,11]),{1:[2,1]},{1:[2,5]},t(r,[2,2]),{6:17,8:5,15:6,16:7,17:8,18:n,20:r},{15:18,16:7,17:8,18:n,20:r},{18:[1,19]},t(r,[2,3]),{12:[1,20]},t(i,[2,10]),{15:21,16:7,17:8,18:n,20:r},t([1,5,10],[2,7])],defaultActions:{11:[2,1],12:[2,5]},parseError:e(function(e,t){if(t.recoverable)this.trace(e);else{var n=Error(e);throw n.hash=t,n}},`parseError`),parse:e(function(t){var n=this,r=[0],i=[],a=[null],o=[],s=this.table,c=``,l=0,u=0,d=0,f=2,p=1,m=o.slice.call(arguments,1),h=Object.create(this.lexer),g={yy:{}};for(var _ in this.yy)Object.prototype.hasOwnProperty.call(this.yy,_)&&(g.yy[_]=this.yy[_]);h.setInput(t,g.yy),g.yy.lexer=h,g.yy.parser=this,typeof h.yylloc>`u`&&(h.yylloc={});var v=h.yylloc;o.push(v);var y=h.options&&h.options.ranges;typeof g.yy.parseError==`function`?this.parseError=g.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function b(e){r.length-=2*e,a.length-=e,o.length-=e}e(b,`popStack`);function x(){var e;return e=i.pop()||h.lex()||p,typeof e!=`number`&&(e instanceof Array&&(i=e,e=i.pop()),e=n.symbols_[e]||e),e}e(x,`lex`);for(var S,C,w,T,E,D={},O,k,A,j;;){if(w=r[r.length-1],this.defaultActions[w]?T=this.defaultActions[w]:((S===null||typeof S>`u`)&&(S=x()),T=s[w]&&s[w][S]),typeof T>`u`||!T.length||!T[0]){var M=``;for(O in j=[],s[w])this.terminals_[O]&&O>f&&j.push(`'`+this.terminals_[O]+`'`);M=h.showPosition?`Parse error on line `+(l+1)+`:
`+h.showPosition()+`
Expecting `+j.join(`, `)+`, got '`+(this.terminals_[S]||S)+`'`:`Parse error on line `+(l+1)+`: Unexpected `+(S==p?`end of input`:`'`+(this.terminals_[S]||S)+`'`),this.parseError(M,{text:h.match,token:this.terminals_[S]||S,line:h.yylineno,loc:v,expected:j})}if(T[0]instanceof Array&&T.length>1)throw Error(`Parse Error: multiple actions possible at state: `+w+`, token: `+S);switch(T[0]){case 1:r.push(S),a.push(h.yytext),o.push(h.yylloc),r.push(T[1]),S=null,C?(S=C,C=null):(u=h.yyleng,c=h.yytext,l=h.yylineno,v=h.yylloc,d>0&&d--);break;case 2:if(k=this.productions_[T[1]][1],D.$=a[a.length-k],D._$={first_line:o[o.length-(k||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(k||1)].first_column,last_column:o[o.length-1].last_column},y&&(D._$.range=[o[o.length-(k||1)].range[0],o[o.length-1].range[1]]),E=this.performAction.apply(D,[c,u,l,g.yy,T[1],a,o].concat(m)),typeof E<`u`)return E;k&&(r=r.slice(0,-1*k*2),a=a.slice(0,-1*k),o=o.slice(0,-1*k)),r.push(this.productions_[T[1]][0]),a.push(D.$),o.push(D._$),A=s[r[r.length-2]][r[r.length-1]],r.push(A);break;case 3:return!0}}return!0},`parse`)};a.lexer=(function(){return{EOF:1,parseError:e(function(e,t){if(this.yy.parser)this.yy.parser.parseError(e,t);else throw Error(e)},`parseError`),setInput:e(function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match=``,this.conditionStack=[`INITIAL`],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},`setInput`),input:e(function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},`input`),unput:e(function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},`unput`),more:e(function(){return this._more=!0,this},`more`),reject:e(function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError(`Lexical error on line `+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:``,token:null,line:this.yylineno});return this},`reject`),less:e(function(e){this.unput(this.match.slice(e))},`less`),pastInput:e(function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?`...`:``)+e.substr(-20).replace(/\n/g,``)},`pastInput`),upcomingInput:e(function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?`...`:``)).replace(/\n/g,``)},`upcomingInput`),showPosition:e(function(){var e=this.pastInput(),t=Array(e.length+1).join(`-`);return e+this.upcomingInput()+`
`+t+`^`},`showPosition`),test_match:e(function(e,t){var n,r,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),r=e[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var a in i)this[a]=i[a];return!1}return!1},`test_match`),next:e(function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r;this._more||(this.yytext=``,this.match=``);for(var i=this._currentRules(),a=0;a<i.length;a++)if(n=this._input.match(this.rules[i[a]]),n&&(!t||n[0].length>t[0].length)){if(t=n,r=a,this.options.backtrack_lexer){if(e=this.test_match(n,i[a]),e!==!1)return e;if(this._backtrack){t=!1;continue}else return!1}else if(!this.options.flex)break}return t?(e=this.test_match(t,i[r]),e===!1?!1:e):this._input===``?this.EOF:this.parseError(`Lexical error on line `+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:``,token:null,line:this.yylineno})},`next`),lex:e(function(){return this.next()||this.lex()},`lex`),begin:e(function(e){this.conditionStack.push(e)},`begin`),popState:e(function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},`popState`),_currentRules:e(function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},`_currentRules`),topState:e(function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:`INITIAL`},`topState`),pushState:e(function(e){this.begin(e)},`pushState`),stateStackSize:e(function(){return this.conditionStack.length},`stateStackSize`),options:{"case-insensitive":!0},performAction:e(function(e,t,n,r){switch(n){case 0:return this.pushState(`csv`),4;case 1:return this.pushState(`csv`),4;case 2:return 10;case 3:return 5;case 4:return 12;case 5:return this.pushState(`escaped_text`),18;case 6:return 20;case 7:return this.popState(`escaped_text`),18;case 8:return 19}},`anonymous`),rules:[/^(?:sankey-beta\b)/i,/^(?:sankey\b)/i,/^(?:$)/i,/^(?:((\u000D\u000A)|(\u000A)))/i,/^(?:(\u002C))/i,/^(?:(\u0022))/i,/^(?:([\u0020-\u0021\u0023-\u002B\u002D-\u007E])*)/i,/^(?:(\u0022)(?!(\u0022)))/i,/^(?:(([\u0020-\u0021\u0023-\u002B\u002D-\u007E])|(\u002C)|(\u000D)|(\u000A)|(\u0022)(\u0022))*)/i],conditions:{csv:{rules:[2,3,4,5,6,7,8],inclusive:!1},escaped_text:{rules:[7,8],inclusive:!1},INITIAL:{rules:[0,1,2,3,4,5,6,7,8],inclusive:!0}}}})();function o(){this.yy={}}return e(o,`Parser`),o.prototype=a,a.Parser=o,new o})();h.parser=h;var g=h,_=[],v=[],y=new Map,b=e(()=>{_=[],v=[],y=new Map,u()},`clear`),x=class{constructor(e,t,n=0){this.source=e,this.target=t,this.value=n}static{e(this,`SankeyLink`)}},S=e((e,t,n)=>{_.push(new x(e,t,n))},`addLink`),C=class{constructor(e){this.ID=e}static{e(this,`SankeyNode`)}},w=e(e=>{e=s.sanitizeText(e,l());let t=y.get(e);return t===void 0&&(t=new C(e),y.set(e,t),v.push(t)),t},`findOrCreateNode`),T=e(()=>v,`getNodes`),E=e(()=>_,`getLinks`),D=e(()=>({nodes:v.map(e=>({id:e.ID})),links:_.map(e=>({source:e.source.ID,target:e.target.ID,value:e.value}))}),`getGraph`),O={nodesMap:y,getConfig:e(()=>l().sankey,`getConfig`),getNodes:T,getLinks:E,getGraph:D,addLink:S,findOrCreateNode:w,getAccTitle:c,setAccTitle:p,getAccDescription:m,setAccDescription:d,getDiagramTitle:a,setDiagramTitle:i,clear:b};function k(e,t){let n;if(t===void 0)for(let t of e)t!=null&&(n<t||n===void 0&&t>=t)&&(n=t);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}e(k,`max`);function A(e,t){let n;if(t===void 0)for(let t of e)t!=null&&(n>t||n===void 0&&t>=t)&&(n=t);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}e(A,`min`);function j(e,t){let n=0;if(t===void 0)for(let t of e)(t=+t)&&(n+=t);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}e(j,`sum`);function M(e){return e.target.depth}e(M,`targetDepth`);function N(e){return e.depth}e(N,`left`);function P(e,t){return t-1-e.height}e(P,`right`);function F(e,t){return e.sourceLinks.length?e.depth:t-1}e(F,`justify`);function I(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?A(e.sourceLinks,M)-1:0}e(I,`center`);function L(e){return function(){return e}}e(L,`constant`);function R(e,t){return B(e.source,t.source)||e.index-t.index}e(R,`ascendingSourceBreadth`);function z(e,t){return B(e.target,t.target)||e.index-t.index}e(z,`ascendingTargetBreadth`);function B(e,t){return e.y0-t.y0}e(B,`ascendingBreadth`);function V(e){return e.value}e(V,`value`);function H(e){return e.index}e(H,`defaultId`);function U(e){return e.nodes}e(U,`defaultNodes`);function ee(e){return e.links}e(ee,`defaultLinks`);function W(e,t){let n=e.get(t);if(!n)throw Error(`missing: `+t);return n}e(W,`find`);function G({nodes:e}){for(let t of e){let e=t.y0,n=e;for(let n of t.sourceLinks)n.y0=e+n.width/2,e+=n.width;for(let e of t.targetLinks)e.y1=n+e.width/2,n+=e.width}}e(G,`computeLinkBreadths`);function K(){let t=0,n=0,r=1,i=1,a=24,o=8,s,c=H,l=F,u,d,f=U,p=ee,m=6;function h(){let e={nodes:f.apply(null,arguments),links:p.apply(null,arguments)};return g(e),_(e),v(e),y(e),S(e),G(e),e}e(h,`sankey`),h.update=function(e){return G(e),e},h.nodeId=function(e){return arguments.length?(c=typeof e==`function`?e:L(e),h):c},h.nodeAlign=function(e){return arguments.length?(l=typeof e==`function`?e:L(e),h):l},h.nodeSort=function(e){return arguments.length?(u=e,h):u},h.nodeWidth=function(e){return arguments.length?(a=+e,h):a},h.nodePadding=function(e){return arguments.length?(o=s=+e,h):o},h.nodes=function(e){return arguments.length?(f=typeof e==`function`?e:L(e),h):f},h.links=function(e){return arguments.length?(p=typeof e==`function`?e:L(e),h):p},h.linkSort=function(e){return arguments.length?(d=e,h):d},h.size=function(e){return arguments.length?(t=n=0,r=+e[0],i=+e[1],h):[r-t,i-n]},h.extent=function(e){return arguments.length?(t=+e[0][0],r=+e[1][0],n=+e[0][1],i=+e[1][1],h):[[t,n],[r,i]]},h.iterations=function(e){return arguments.length?(m=+e,h):m};function g({nodes:e,links:t}){for(let[t,n]of e.entries())n.index=t,n.sourceLinks=[],n.targetLinks=[];let n=new Map(e.map((t,n)=>[c(t,n,e),t]));for(let[e,r]of t.entries()){r.index=e;let{source:t,target:i}=r;typeof t!=`object`&&(t=r.source=W(n,t)),typeof i!=`object`&&(i=r.target=W(n,i)),t.sourceLinks.push(r),i.targetLinks.push(r)}if(d!=null)for(let{sourceLinks:t,targetLinks:n}of e)t.sort(d),n.sort(d)}e(g,`computeNodeLinks`);function _({nodes:e}){for(let t of e)t.value=t.fixedValue===void 0?Math.max(j(t.sourceLinks,V),j(t.targetLinks,V)):t.fixedValue}e(_,`computeNodeValues`);function v({nodes:e}){let t=e.length,n=new Set(e),r=new Set,i=0;for(;n.size;){for(let e of n){e.depth=i;for(let{target:t}of e.sourceLinks)r.add(t)}if(++i>t)throw Error(`circular link`);n=r,r=new Set}}e(v,`computeNodeDepths`);function y({nodes:e}){let t=e.length,n=new Set(e),r=new Set,i=0;for(;n.size;){for(let e of n){e.height=i;for(let{source:t}of e.targetLinks)r.add(t)}if(++i>t)throw Error(`circular link`);n=r,r=new Set}}e(y,`computeNodeHeights`);function b({nodes:e}){let n=k(e,e=>e.depth)+1,i=(r-t-a)/(n-1),o=Array(n);for(let r of e){let e=Math.max(0,Math.min(n-1,Math.floor(l.call(null,r,n))));r.layer=e,r.x0=t+e*i,r.x1=r.x0+a,o[e]?o[e].push(r):o[e]=[r]}if(u)for(let e of o)e.sort(u);return o}e(b,`computeNodeLayers`);function x(e){let t=A(e,e=>(i-n-(e.length-1)*s)/j(e,V));for(let r of e){let e=n;for(let n of r){n.y0=e,n.y1=e+n.value*t,e=n.y1+s;for(let e of n.sourceLinks)e.width=e.value*t}e=(i-e+s)/(r.length+1);for(let t=0;t<r.length;++t){let n=r[t];n.y0+=e*(t+1),n.y1+=e*(t+1)}M(r)}}e(x,`initializeNodeBreadths`);function S(e){let t=b(e);s=Math.min(o,(i-n)/(k(t,e=>e.length)-1)),x(t);for(let e=0;e<m;++e){let n=.99**e,r=Math.max(1-n,(e+1)/m);w(t,n,r),C(t,n,r)}}e(S,`computeNodeBreadths`);function C(e,t,n){for(let r=1,i=e.length;r<i;++r){let i=e[r];for(let e of i){let n=0,r=0;for(let{source:t,value:i}of e.targetLinks){let a=i*(e.layer-t.layer);n+=N(t,e)*a,r+=a}if(!(r>0))continue;let i=(n/r-e.y0)*t;e.y0+=i,e.y1+=i,O(e)}u===void 0&&i.sort(B),T(i,n)}}e(C,`relaxLeftToRight`);function w(e,t,n){for(let r=e.length-2;r>=0;--r){let i=e[r];for(let e of i){let n=0,r=0;for(let{target:t,value:i}of e.sourceLinks){let a=i*(t.layer-e.layer);n+=P(e,t)*a,r+=a}if(!(r>0))continue;let i=(n/r-e.y0)*t;e.y0+=i,e.y1+=i,O(e)}u===void 0&&i.sort(B),T(i,n)}}e(w,`relaxRightToLeft`);function T(e,t){let r=e.length>>1,a=e[r];D(e,a.y0-s,r-1,t),E(e,a.y1+s,r+1,t),D(e,i,e.length-1,t),E(e,n,0,t)}e(T,`resolveCollisions`);function E(e,t,n,r){for(;n<e.length;++n){let i=e[n],a=(t-i.y0)*r;a>1e-6&&(i.y0+=a,i.y1+=a),t=i.y1+s}}e(E,`resolveCollisionsTopToBottom`);function D(e,t,n,r){for(;n>=0;--n){let i=e[n],a=(i.y1-t)*r;a>1e-6&&(i.y0-=a,i.y1-=a),t=i.y0-s}}e(D,`resolveCollisionsBottomToTop`);function O({sourceLinks:e,targetLinks:t}){if(d===void 0){for(let{source:{sourceLinks:e}}of t)e.sort(z);for(let{target:{targetLinks:t}}of e)t.sort(R)}}e(O,`reorderNodeLinks`);function M(e){if(d===void 0)for(let{sourceLinks:t,targetLinks:n}of e)t.sort(z),n.sort(R)}e(M,`reorderLinks`);function N(e,t){let n=e.y0-(e.sourceLinks.length-1)*s/2;for(let{target:r,width:i}of e.sourceLinks){if(r===t)break;n+=i+s}for(let{source:r,width:i}of t.targetLinks){if(r===e)break;n-=i}return n}e(N,`targetTop`);function P(e,t){let n=t.y0-(t.targetLinks.length-1)*s/2;for(let{source:r,width:i}of t.targetLinks){if(r===e)break;n+=i+s}for(let{target:r,width:i}of e.sourceLinks){if(r===t)break;n-=i}return n}return e(P,`sourceTop`),h}e(K,`Sankey`);var q=Math.PI,J=2*q,Y=1e-6,te=J-Y;function X(){this._x0=this._y0=this._x1=this._y1=null,this._=``}e(X,`Path`);function Z(){return new X}e(Z,`path`),X.prototype=Z.prototype={constructor:X,moveTo:e(function(e,t){this._+=`M`+(this._x0=this._x1=+e)+`,`+(this._y0=this._y1=+t)},`moveTo`),closePath:e(function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+=`Z`)},`closePath`),lineTo:e(function(e,t){this._+=`L`+(this._x1=+e)+`,`+(this._y1=+t)},`lineTo`),quadraticCurveTo:e(function(e,t,n,r){this._+=`Q`+ +e+`,`+ +t+`,`+(this._x1=+n)+`,`+(this._y1=+r)},`quadraticCurveTo`),bezierCurveTo:e(function(e,t,n,r,i,a){this._+=`C`+ +e+`,`+ +t+`,`+ +n+`,`+ +r+`,`+(this._x1=+i)+`,`+(this._y1=+a)},`bezierCurveTo`),arcTo:e(function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,c=r-t,l=a-e,u=o-t,d=l*l+u*u;if(i<0)throw Error(`negative radius: `+i);if(this._x1===null)this._+=`M`+(this._x1=e)+`,`+(this._y1=t);else if(d>Y)if(!(Math.abs(u*s-c*l)>Y)||!i)this._+=`L`+(this._x1=e)+`,`+(this._y1=t);else{var f=n-a,p=r-o,m=s*s+c*c,h=f*f+p*p,g=Math.sqrt(m),_=Math.sqrt(d),v=i*Math.tan((q-Math.acos((m+d-h)/(2*g*_)))/2),y=v/_,b=v/g;Math.abs(y-1)>Y&&(this._+=`L`+(e+y*l)+`,`+(t+y*u)),this._+=`A`+i+`,`+i+`,0,0,`+ +(u*f>l*p)+`,`+(this._x1=e+b*s)+`,`+(this._y1=t+b*c)}},`arcTo`),arc:e(function(e,t,n,r,i,a){e=+e,t=+t,n=+n,a=!!a;var o=n*Math.cos(r),s=n*Math.sin(r),c=e+o,l=t+s,u=1^a,d=a?r-i:i-r;if(n<0)throw Error(`negative radius: `+n);this._x1===null?this._+=`M`+c+`,`+l:(Math.abs(this._x1-c)>Y||Math.abs(this._y1-l)>Y)&&(this._+=`L`+c+`,`+l),n&&(d<0&&(d=d%J+J),d>te?this._+=`A`+n+`,`+n+`,0,1,`+u+`,`+(e-o)+`,`+(t-s)+`A`+n+`,`+n+`,0,1,`+u+`,`+(this._x1=c)+`,`+(this._y1=l):d>Y&&(this._+=`A`+n+`,`+n+`,0,`+ +(d>=q)+`,`+u+`,`+(this._x1=e+n*Math.cos(i))+`,`+(this._y1=t+n*Math.sin(i))))},`arc`),rect:e(function(e,t,n,r){this._+=`M`+(this._x0=this._x1=+e)+`,`+(this._y0=this._y1=+t)+`h`+ +n+`v`+ +r+`h`+-n+`Z`},`rect`),toString:e(function(){return this._},`toString`)};var ne=Z;function Q(t){return e(function(){return t},`constant`)}e(Q,`default`);function re(e){return e[0]}e(re,`x`);function ie(e){return e[1]}e(ie,`y`);var ae=Array.prototype.slice;function oe(e){return e.source}e(oe,`linkSource`);function se(e){return e.target}e(se,`linkTarget`);function ce(t){var n=oe,r=se,i=re,a=ie,o=null;function s(){var e,s=ae.call(arguments),c=n.apply(this,s),l=r.apply(this,s);if(o||=e=ne(),t(o,+i.apply(this,(s[0]=c,s)),+a.apply(this,s),+i.apply(this,(s[0]=l,s)),+a.apply(this,s)),e)return o=null,e+``||null}return e(s,`link`),s.source=function(e){return arguments.length?(n=e,s):n},s.target=function(e){return arguments.length?(r=e,s):r},s.x=function(e){return arguments.length?(i=typeof e==`function`?e:Q(+e),s):i},s.y=function(e){return arguments.length?(a=typeof e==`function`?e:Q(+e),s):a},s.context=function(e){return arguments.length?(o=e??null,s):o},s}e(ce,`link`);function le(e,t,n,r,i){e.moveTo(t,n),e.bezierCurveTo(t=(t+r)/2,n,t,i,r,i)}e(le,`curveHorizontal`);function $(){return ce(le)}e($,`linkHorizontal`);function ue(e){return[e.source.x1,e.y0]}e(ue,`horizontalSource`);function de(e){return[e.target.x0,e.y1]}e(de,`horizontalTarget`);function fe(){return $().source(ue).target(de)}e(fe,`default`);var pe=class t{static{e(this,`Uid`)}static{this.count=0}static next(e){return new t(e+ ++t.count)}constructor(e){this.id=e,this.href=`#${e}`}toString(){return`url(`+this.href+`)`}},me={left:N,right:P,center:I,justify:F},he={draw:e(function(i,a,s,c){let{securityLevel:u,sankey:d}=l(),p=f.sankey,m;u===`sandbox`&&(m=t(`#i`+a));let h=t(u===`sandbox`?m.nodes()[0].contentDocument.body:`body`),g=u===`sandbox`?h.select(`[id="${a}"]`):t(`[id="${a}"]`),_=d?.width??p.width,v=d?.height??p.width,y=d?.useMaxWidth??p.useMaxWidth,b=d?.nodeAlignment??p.nodeAlignment,x=d?.prefix??p.prefix,S=d?.suffix??p.suffix,C=d?.showValues??p.showValues,w=c.db.getGraph(),T=me[b];K().nodeId(e=>e.id).nodeWidth(10).nodePadding(10+(C?15:0)).nodeAlign(T).extent([[0,0],[_,v]])(w);let E=n(r);g.append(`g`).attr(`class`,`nodes`).selectAll(`.node`).data(w.nodes).join(`g`).attr(`class`,`node`).attr(`id`,e=>(e.uid=pe.next(`node-`)).id).attr(`transform`,function(e){return`translate(`+e.x0+`,`+e.y0+`)`}).attr(`x`,e=>e.x0).attr(`y`,e=>e.y0).append(`rect`).attr(`height`,e=>e.y1-e.y0).attr(`width`,e=>e.x1-e.x0).attr(`fill`,e=>E(e.id));let D=e(({id:e,value:t})=>C?`${e}
${x}${Math.round(t*100)/100}${S}`:e,`getText`);g.append(`g`).attr(`class`,`node-labels`).attr(`font-size`,14).selectAll(`text`).data(w.nodes).join(`text`).attr(`x`,e=>e.x0<_/2?e.x1+6:e.x0-6).attr(`y`,e=>(e.y1+e.y0)/2).attr(`dy`,`${C?`0`:`0.35`}em`).attr(`text-anchor`,e=>e.x0<_/2?`start`:`end`).text(D);let O=g.append(`g`).attr(`class`,`links`).attr(`fill`,`none`).attr(`stroke-opacity`,.5).selectAll(`.link`).data(w.links).join(`g`).attr(`class`,`link`).style(`mix-blend-mode`,`multiply`),k=d?.linkColor??`gradient`;if(k===`gradient`){let e=O.append(`linearGradient`).attr(`id`,e=>(e.uid=pe.next(`linearGradient-`)).id).attr(`gradientUnits`,`userSpaceOnUse`).attr(`x1`,e=>e.source.x1).attr(`x2`,e=>e.target.x0);e.append(`stop`).attr(`offset`,`0%`).attr(`stop-color`,e=>E(e.source.id)),e.append(`stop`).attr(`offset`,`100%`).attr(`stop-color`,e=>E(e.target.id))}let A;switch(k){case`gradient`:A=e(e=>e.uid,`coloring`);break;case`source`:A=e(e=>E(e.source.id),`coloring`);break;case`target`:A=e(e=>E(e.target.id),`coloring`);break;default:A=k}O.append(`path`).attr(`d`,fe()).attr(`stroke`,A).attr(`stroke-width`,e=>Math.max(1,e.width)),o(void 0,g,0,y)},`draw`)},ge=e(e=>e.replaceAll(/^[^\S\n\r]+|[^\S\n\r]+$/g,``).replaceAll(/([\n\r])+/g,`
`).trim(),`prepareTextForParsing`),_e=e(e=>`.label {
      font-family: ${e.fontFamily};
    }`,`getStyles`),ve=g.parse.bind(g);g.parse=e=>ve(ge(e));var ye={styles:_e,parser:g,db:O,renderer:he};export{ye as diagram};